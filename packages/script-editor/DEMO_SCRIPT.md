# 可视化节点编辑功能演示脚本

本文档提供了一个完整的演示流程，展示如何使用可视化节点编辑功能。

## 演示准备

### 1. 启动服务
```bash
# Terminal 1: 启动 PostgreSQL（如果使用 Docker）
docker-compose -f docker-compose.dev.yml up -d

# Terminal 2: 启动后端服务
cd packages/api-server
pnpm run dev

# Terminal 3: 启动前端服务  
cd packages/script-editor
pnpm run dev
```

### 2. 准备测试数据

确保数据库中有：
- 至少一个测试工程
- 该工程包含一个会谈脚本文件
- 会谈脚本中包含 `ai_say`、`ai_ask`、`ai_think` 类型的 Action

如果没有，可以通过 API 或前端界面创建。

## 演示流程

### 第一部分：工程管理（2分钟）

**场景**：展示如何进入脚本编辑界面

1. **打开工程列表**
   - 访问 `http://localhost:3002/`
   - 展示工程列表界面
   - 说明：这里显示了所有的脚本工程

2. **选择工程**
   - 点击某个工程的"编辑"按钮
   - 说明：进入工程编辑器

3. **界面概览**
   - 指出三栏布局：
     - 左侧：文件树
     - 中间：编辑器
     - 右侧：属性面板
   - 说明：这是一个完整的工程编辑环境

### 第二部分：YAML 模式编辑（3分钟）

**场景**：展示传统的 YAML 文本编辑

1. **选择会谈脚本**
   - 从左侧文件树点击"会谈脚本"文件夹
   - 选择一个 session 文件
   - 说明：这是一个会谈流程脚本

2. **查看 YAML 内容**
   - 展示 YAML 编辑器
   - 滚动查看脚本结构
   - 指出几个 Action 节点
   - 说明：这是传统的文本编辑方式

3. **尝试修改**
   - 修改一个 `ai_say` 的内容
   - 展示"未保存"标签出现
   - 说明：可以直接编辑 YAML，但需要记住语法

### 第三部分：可视化编辑模式（8分钟）

**场景**：重点展示可视化节点编辑功能

#### 3.1 切换到可视化模式（1分钟）

1. **模式切换**
   - 点击顶部的"可视化编辑"按钮
   - 界面变为双栏布局
   - 说明：左侧是节点列表，右侧是配置面板

2. **节点列表概览**
   - 滚动左侧节点列表
   - 指出不同类型的节点（图标和颜色）
   - 说明：每个节点都是一个 Action，可以看到摘要信息

#### 3.2 编辑 ai_say 节点（2分钟）

1. **选择节点**
   - 点击一个蓝色的"AI 说话"节点
   - 节点高亮显示
   - 右侧显示配置表单

2. **查看配置**
   - 展示"提示词内容"字段
   - 展示"语气风格"字段
   - 展示"高级配置"折叠面板

3. **修改内容**
   - 在提示词中添加一些内容
   - 在"语气风格"输入"温柔"
   - 点击"保存"按钮
   - 显示"Action 已更新"提示

4. **验证修改**
   - 切换回 YAML 模式
   - 找到对应的 Action
   - 展示修改已经同步到 YAML
   - 说明：修改会自动同步

#### 3.3 配置 ai_ask 节点（3分钟）

1. **选择 ai_ask 节点**
   - 切换回可视化模式
   - 点击一个绿色的"AI 提问"节点

2. **配置基本信息**
   - 修改提示词内容
   - 设置语气风格为"鼓励"
   - 填写退出条件：`当心旅者回答完问题`

3. **配置输出变量**
   - 展示"输出变量配置"区域
   - 点击"添加输出变量"按钮
   - 配置第一个变量：
     - `get`: 当前情绪
     - `define`: 提取心旅者的当前情绪状态
   - 再添加一个变量：
     - `get`: 情绪强度
     - `define`: 评估情绪的强度等级（1-10）

4. **保存并验证**
   - 点击"保存"按钮
   - 切换到 YAML 模式查看生成的代码
   - 说明：输出变量已经正确添加到 YAML

#### 3.4 使用 ai_think 节点（2分钟）

1. **选择 ai_think 节点**
   - 切换回可视化模式
   - 点击一个黄色的"AI 思考"节点

2. **配置思考内容**
   - 填写思考提示词
   - 添加输出变量（使用 `set` 方式）：
     - `set`: 心旅者姓名
     - `value`: 小明
   - 添加另一个变量（使用 `get` 方式）：
     - `get`: 分析结果
     - `define`: 提取初步分析的结果

3. **保存修改**
   - 点击"保存"按钮
   - 说明：ai_think 支持两种输出方式

### 第四部分：保存和发布（2分钟）

**场景**：演示如何持久化修改并发布版本

1. **保存到服务器**
   - 返回 YAML 模式（可选）
   - 点击顶部的"保存"按钮
   - 显示"保存成功"提示
   - 说明：修改已经保存到数据库

2. **发布新版本**
   - 点击"发布版本"按钮
   - 弹出对话框
   - 填写版本说明：`添加了温柔的语气设定，完善了情绪提取逻辑`
   - 点击"确认发布"
   - 显示"版本 vX.X.X 发布成功"
   - 说明：版本已发布，可以回滚或对比

### 第五部分：总结（1分钟）

**要点回顾**

1. **双模式编辑**
   - YAML 模式：适合熟悉语法的用户
   - 可视化模式：更直观友好

2. **三种核心 Action**
   - `ai_say`：让 AI 说话，可设置语气
   - `ai_ask`：让 AI 提问，可提取变量
   - `ai_think`：内部思考，可设置或提取变量

3. **实时同步**
   - 可视化修改立即同步到 YAML
   - 两种模式可以自由切换

4. **版本管理**
   - 支持保存草稿
   - 支持发布版本
   - 未来支持版本回滚和对比

## 演示技巧

### 准备工作
1. 提前准备好一个包含多种 Action 类型的示例脚本
2. 确保网络和服务运行正常
3. 清空浏览器缓存，确保显示最新代码

### 演示节奏
1. 慢速操作，确保观众能看清楚每一步
2. 每个操作后稍作停顿，给观众思考时间
3. 重要信息重复强调 2-3 次

### 互动建议
1. 询问观众："有没有人用过类似的工具？"
2. 展示出错恢复："看，如果我填错了，可以直接改回来"
3. 邀请观众提问："大家有什么问题吗？"

### 亮点强调
1. **易用性**：不需要记住 YAML 语法
2. **实时反馈**：修改立即生效
3. **双向同步**：代码和界面保持一致
4. **专业性**：适合心理咨询领域的专业配置

## 常见问题应对

### Q: 这个和其他低代码工具有什么区别？
A: 我们专注于心理咨询脚本编辑，提供了专门的 Action 类型和配置选项，更贴合咨询师的工作流程。

### Q: 可以支持更多的 Action 类型吗？
A: 可以！这只是第一版，我们计划支持表单、技能调用等更多类型。

### Q: 如果 YAML 格式不对，会怎样？
A: 系统会自动检测，解析失败时会禁用可视化模式，你可以在 YAML 模式下修复。

### Q: 多人协作怎么办？
A: 目前支持版本管理，未来计划加入权限控制和冲突解决机制。

## 后续演示建议

如果时间充裕，可以增加以下内容：

1. **完整工作流演示**：从创建工程到发布版本的完整流程
2. **复杂脚本展示**：包含条件分支、循环、表单的复杂脚本
3. **性能测试**：展示大型脚本（50+ Action）的编辑性能
4. **错误处理**：故意制造错误，展示系统如何提示和恢复
5. **版本对比**：展示两个版本之间的差异

## 录制建议

如果要录制演示视频：

1. **分辨率**：1920x1080，确保文字清晰
2. **录屏工具**：OBS Studio、ScreenFlow 等
3. **麦克风**：使用质量好的麦克风，避免杂音
4. **时长控制**：总时长建议 10-15 分钟
5. **后期处理**：
   - 添加字幕标注重点
   - 添加放大镜效果突出细节
   - 加入背景音乐（轻柔、不抢戏）
   - 每个部分之间加入过渡动画
